<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE node PUBLIC "-//freedesktop//DTD D-BUS Object Introspection 1.0//EN" "http://www.freedesktop.org/standards/dbus/1.0/introspect.dtd">
<node xmlns:doc="http://www.freedesktop.org/dbus/1.0/doc.dtd">
    <interface name="com.kylinsec.SC.BoxManager">

        <method name="GetBoxs">
            <arg type="s" name="boxs" direction="out">
                <summary>A json string which describes boxs information.</summary>
            </arg>
            <description>Get boxs information.</description>
        </method>

        <method name="GetBoxByUID">
            <arg type="s" name="box_uid" direction="in">
                <summary>The box UID.</summary>
            </arg>
            <arg type="s" name="box" direction="out">
                <summary>A json string which describes box information.</summary>
            </arg>
            <description>Get box information.</description>
        </method>

        <method name="CreateBox">
            <arg type="s" name="name" direction="in">
                <summary>The box name.</summary>
            </arg>
            <arg type="s" name="password" direction="in">
                <summary>The password needs to be encrypted by RSA algorithm using RSAPublicKey.</summary>
            </arg>
            <arg type="s" name="box_uid" direction="out">
                <summary>The box UID.</summary>
            </arg>
            <description>Create a encrypted box.</description>
        </method>

        <method name="DelBox">
            <arg type="s" name="box_uid" direction="in">
                <summary>The box UID.</summary>
            </arg>
            <arg type="s" name="password" direction="in">
                <summary>The password needs to be encrypted by RSA algorithm using RSAPublicKey.</summary>
            </arg>
            <description>DelBox a encrypted box.</description>
        </method>

        <method name="ModifyBoxPassword">
            <arg type="s" name="box_uid" direction="in">
                <summary>The box UID.</summary>
            </arg>
            <arg type="s" name="current_password" direction="in">
                <summary>The current password which needs to be encrypted by RSA algorithm using RSAPublicKey.</summary>
            </arg>
            <arg type="s" name="new_password" direction="in">
                <summary>The new password which needs to be encrypted by RSA algorithm using RSAPublicKey.</summary>
            </arg>
            <description>Modify password for box.</description>
        </method>

        <method name="Mount">
            <arg type="s" name="box_uid" direction="in">
                <summary>The box UID.</summary>
            </arg>
            <arg type="s" name="password" direction="in">
                <summary>The password needs to be encrypted by RSA algorithm using RSAPublicKey.</summary>
            </arg>
            <arg type="b" name="unlocked" direction="out">
                <summary>Whether to unlock.</summary>
            </arg>
            <description>Mount the box.</description>
        </method>

        <method name="UnMount">
            <arg type="s" name="box_uid" direction="in">
                <summary>The box UID.</summary>
            </arg>
            <description>UnMount the box.</description>
        </method>

        <method name="IsMounted">
            <arg type="s" name="box_uid" direction="in">
                <summary>The box UID.</summary>
            </arg>
            <arg type="b" name="mounted" direction="out">
                <summary>Whether the box is mounted.</summary>
            </arg>
            <description>Return true if the box is mounted else return false.</description>
        </method>

        <property name="RSAPublicKey" type="s" access="read">
            <description>The RSA public key.</description>
        </property>

        <signal name="BoxAdded">
            <arg name="box_uid" type="s">
                <summary>The box UID.</summary>
            </arg>
            <description>Emit the signal when box is added.</description>
        </signal>

        <signal name="BoxDeleted">
            <arg name="box_uid" type="s">
                <summary>The box UID.</summary>
            </arg>
            <description>Emit the signal when box is deleted.</description>
        </signal>

        <signal name="BoxChanged">
            <arg name="box_uid" type="s">
                <summary>The box UID.</summary>
            </arg>
            <description>Emit the signal when the status of box is changed.</description>
        </signal>


    </interface>
</node>
